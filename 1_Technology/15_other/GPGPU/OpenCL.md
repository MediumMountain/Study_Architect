# OpenCL
- 様々なデバイスで使えるプログラム言語であり、GPUを活用した並列計算を行うために使われます。
- OpenCLを使用することで、CPUのみを使用する場合よりも高速に処理を行うことができます

OpenCL（Open Computing Language）は、CPU（Central Processing Unit）、GPU（Graphics Processing Unit）、DSP（Digital Signal Processor）、FPGA（Field Programmable Gate Array）などで構成される異種混在環境（ヘテロジニアス・システム）で並列処理を使用するプログラムを作成するためのフレームワークで、オープンかつロイヤルティー・フリーの標準規格です。標準 ANSI C (C99) をベースとしたプログラミング言語で、ソフトウェア開発者が様々なプラットフォームに対しパフォーマンス向上をもたらすことのできるプログラミング・モデルです。2008年6月に米アップルが発表したのち、現在は米クロノス・グループがAPIの策定を行っています。

OpenCLでは、ホスト（CPU）とデバイス（GPU）があります。ホスト側でOpenCLプログラムを作成し、デバイスに処理を割り当てます。そして、デバイス上で並列処理を行い、結果をホストに返します。

OpenCLのプログラムは、次のような構成になっています。

1. プラットフォームの選択
2. デバイスの選択
3. コンテキストの作成
4. プログラムの作成とコンパイル
5. カーネルの作成
6. キューの作成
7. データの転送
8. カーネルの実行
9. 結果の取得




https://www.fu.is.saga-u.ac.jp/yaman/OPENGLCL/openglcl.pdf




https://vlsi.jp/tsukaouOpenCL.html


OpenCLの思想
OpenCLの思想としてループの関数(カーネル)への展開



OpenCLの計算機システム
OpenCLにとって計算機システムは、単一の制御用のホストと一つ以上のデバイスによって構成されている。そしてデバイスは一つ以上のCompute Unit(CU) からなる。またCUも一つ以上のProcessing Element(PE) から構成される。 メモリシステムもホストメモリとデバイスメモリに大別される。ホストとデバイスを合わせてプラットフォームとも呼ぶ。

OpenCLのプログラムは、GPU上で動くカーネルプログラムとCPU上で動くホストプログラムに分かれている。



???????
OpenCLの次元
解きたい問題には全て、直線状やキューブ状や平面状のようにある程度の次元性が存在している。 OpenCLでは最大3次元までを指定してカーネルを展開する。また各次元方向のサイズも指定する必要がある。この各次元のサイズをグローバルサイズと呼ぶ。そして各点はワークアイテムによって処理される。

このワークアイテムを纏めたものをワークグループと呼ぶ。1つのワークグループに1つのCUが割り当てられ、ワークグループ内ではローカルメモリの共有と同期が可能である。

ワークグループ内にあるワークアイテムの数を指定することが可能であり、これをローカル(ワークグループ)サイズと呼ぶ。OpenCLランタイムにこのローカルサイズを自動に決定させることも可能だが、大抵の場合最適ではない。

アルゴリズムに最も適した次元を選ぶことが非常に重要である。








# OpenCL使用方法







# 補足

## OpenCVでのOpenCLサポート
- Ocl.cpp
https://docs.opencv.org/4.x/dc/d83/group__core__opencl.html

https://qiita.com/TakenoriHirao/items/59a0ceb1bbf0beb3ceb5
https://qiita.com/tackson5/items/8dac6b083071d31baf00